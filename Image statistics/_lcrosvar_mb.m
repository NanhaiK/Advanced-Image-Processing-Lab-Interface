function OUTIMG=lcrosvar_mb(INPIMG,LX,LY,ROSL,ROSR)INPIMG = double(INPIMG);% LOCAL rank order statistics (ROS) variance over window (LX=2Lx+1,LY=2Ly+1)% LCROSVAR =ROSRight-ROSLeft;% Image mirror extension by the size of the spatial window% Call OUTIMG=lcrosvar(INPIMG,LX,LY,ROSL,ROSR);%LX=input('Enter window vertical size LX = ');Lx=round((LX-1)/2);%LY=input('Enter window horizontal size LY = ');Ly=round((LY-1)/2);%ROSR=input('Enter right ROS number (ROS(min)=1;ROS(max)=LX*LY) ROSR = ');%ROSL=input('Enter left ROS number (ROS(min)=1;ROS(max)=LX*LY) ROSL = ');[SzX SzY]=size(INPIMG);OUTIMG=zeros(SzX,SzY);imgext=img_ext_mb(INPIMG,Ly,Lx);% LOCAL QUASI SPREAD% nbhood1 = im2col(imgext,[2*Ly+1 2*Lx+1],'sliding')';% sortnbhood1=sort(nbhood1, 2);for X0=1:SzX,	% FORMATION OF NEIGHBORHOOD MATRIX	nbhood=zeros((2*Lx+1)*(2*Ly+1),SzY);	Y=1:SzY;    for y=-Ly:Ly        nbhood((2*Lx+1)*(Ly+y)+1:(2*Lx+1)*(Ly+y+1),Y)=imgext(X0:X0+2*Lx,Y+Ly+y);    end    sortnbhood=sort(nbhood);    OUTIMG(X0,:)=sortnbhood(ROSR,:)-sortnbhood(ROSL,:);endOUTIMG=255*(OUTIMG-min(min(OUTIMG)))/(max(max(OUTIMG))-min(min(OUTIMG))); 	