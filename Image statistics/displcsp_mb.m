function [ frgm, fft_res, dct_res,  walsh_res, haar_res] = displcsp_mb(INPIMG,X, Y, WSzX,WSzY)p = 1; % p = 0.15;INPIMG = double(INPIMG);% Display image local spectra in % DFT, DCT, Haar and Walsh-Hadamard bases for% Image fragment selected interactively% WSzX,WSzY - dimensions of image fragment (should be power of 2)% For Walsh and Haar spectra fragment is a square of WSzX*WSzX pixels% Call displcsp(INPIMG,Window Size X,Window Size Y);n=log(WSzX)/log(2);wal=walsh_mb(n);har=haar_mb(n);Lx=round((WSzX-1)/2);Ly=round((WSzY-1)/2);[SzX SzY]=size(INPIMG);imgext=img_ext_mb(INPIMG,Lx,Ly);frgm=imgext(X:X+WSzX-1,Y:Y+WSzY-1);spdft=fft2(frgm);phase=atan(real(spdft)./(imag(spdft)+eps));spdft=abs(spdft).^2;spdftsort=reshape(spdft,1,WSzX*WSzY);spdftsort=sort(spdftsort);spdftsort=spdftsort(WSzX*WSzY-1:-1:1);spdftsort=spdftsort/sum(spdftsort);R=sum(cumsum(spdftsort)<0.99)/(WSzX*WSzY-1);spdct=dct2(frgm);sign_dct=sign(spdct); spdct=abs(spdct).^2;spdctsort=reshape(spdct,1,WSzX*WSzY);spdctsort=sort(spdctsort);spdctsort=spdctsort(WSzX*WSzY-1:-1:1);spdctsort=spdctsort/sum(spdctsort);C=sum(cumsum(spdctsort)<0.99)/(WSzX*WSzY-1);spwalsh=abs(wal*(wal*frgm)').^2;spwalshsort=reshape(spwalsh,1,WSzX*WSzX);spwalshsort=sort(spwalshsort);spwalshsort=spwalshsort(WSzX*WSzY-1:-1:1);spwalshsort=spwalshsort/sum(spwalshsort);G=sum(cumsum(spwalshsort)<0.99)/(WSzX*WSzY-1);sphaar=abs(har*(har*frgm)').^2;sphaarsort=reshape(sphaar,1,WSzX*WSzX);sphaarsort=sort(sphaarsort);sphaarsort=sphaarsort(WSzX*WSzY-1:-1:1);sphaarsort=sphaarsort/sum(sphaarsort);B=sum(cumsum(sphaarsort)<0.99)/(WSzX*WSzY-1);fft_res = fftshift(spdft.^p);dct_res  =spdct(WSzX:-1:1,:).^p;walsh_res = abs(spwalsh(WSzX:-1:1,:)).^p;haar_res = abs(sphaar(WSzX:-1:1,:)).^p;