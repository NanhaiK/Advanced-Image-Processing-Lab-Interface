function OUTIMG=lcmedian_mb(INPIMG,LX,LY)% LOCAL MEDIAN FILTERING OVER WINDOW (2Lx+1,2Ly+1)% Image mirror extension by the size of the spatial window% Call OUTIMG=lcmedian(INPIMG,LX,LY);clfcolormap(gray(256));%LX=input('Enter window vertical size LX = ');Lx=round((LX-1)/2);%LY=input('Enter window horizontal size LY = ');Ly=round((LY-1)/2);[SzX SzY]=size(INPIMG);%subplot(211);display1(INPIMG);OUTIMG=INPIMG;imgext=img_ext_mb(INPIMG,Lx,Ly);% LOCAL MEDIANfor X0=1:SzX,	% FORMATION OF NEIGHBORHOOD MATRIX	nbhood=zeros((2*Lx+1)*(2*Ly+1),SzY); 	Y=1:SzY;	for y=-Ly:Ly,nbhood((2*Lx+1)*(Ly+y)+1:(2*Lx+1)*(Ly+y+1),Y)=imgext(X0:X0+2*Lx,Y+Ly+y);	endOUTIMG(X0,:)=median(nbhood);%subplot(212);display1(OUTIMG);title(['lcmedian,m: Output image; LX*LY=',num2str(LX),'*',num2str(LY)]);drawnow;end 	