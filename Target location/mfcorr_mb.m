function [Y X]=mfcorr_mb(INPIMG1,TRGT)    % Matched filter correlation    % Call corr=mfcorr(INPIMG1,INPIMG2)    INPIMG1 = double(INPIMG1);    TRGT = double(TRGT);    %% filtering with matched filter    spimg = fft2(INPIMG1);    mtchfilter=conj(fft2(TRGT,size(spimg,1), size(spimg,2)));    corr=real(ifft2(spimg.*mtchfilter));    X = locatmax_mb(corr);    Y = max(1, min(size(INPIMG1,1), X(2)+size(TRGT,1)/2)); X = max(1, min(size(INPIMG1,2), X(1)+size(TRGT,2)/2));end