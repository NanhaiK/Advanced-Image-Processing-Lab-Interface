function [Y, X]=optcorr_mb(INPIMG1,TRGT, k)    % Optimal adaptive filter correlator    INPIMG1 = double(INPIMG1);    TRGT = double(TRGT);    %mtchfilter=conj(fft2(TRGT));    spimg=fft2(INPIMG1);    mtchfilter=conj(fft2(TRGT, size(spimg,1), size(spimg,2)));    spimg2=(abs(spimg)).^2;    mask=ones(5)/25;    if     k==0          spimg2=conv2(spimg2,mask,'same'); % implant model    else        spimg2=spimg2+(abs(mtchfilter).^2); % additive model     end    corr=real(ifft2(spimg.*mtchfilter./spimg2));    X = locatmax_mb(corr);    Y = max(1, min(size(INPIMG1,1), X(2)+size(TRGT,1)/2 )); X = max(1, min(size(INPIMG1,2), X(1)+size(TRGT,2)/2 ));end