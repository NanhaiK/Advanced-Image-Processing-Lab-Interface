function OUT=certfimp_mb(INIIMG,NOISIMG,FILTIMG)% Certification of algorithms for filtering impulse noise in images.% INIIMG - initial image;% NOISIMG - image with impulse noise;% FILTIMG - filtered image.% Evaluated are:% STDprer - Standard deviation of the prediction error % Pn =Probability of impulse interference in the particular realization of noise;% STDn - Standard deviation of the residual noise% Pfd=Probability of false detection of noise interference% Pm =Probability of missing noise interference% STDfd -Standard deviation of errors due to false noise detection% STDm - Standard deviation of errors due to missing noise interference% STDest - Standard deviation of detected corrupted pixel estimation errors% OUT=[STDprer Pn STDn Pfd STDfd Pm STDm STDest]% Call OUT=certfimp(INIIMG,NOISIMG,FILTIMG)[SzX SzY]=size(INIIMG);Sz=SzX*SzY;mask=[-0.1 -0.15 -0.1;-0.15 1 -0.15;-0.1 -0.15 -0.1];STDprer=std2(conv2(INIIMG,mask));ARR_T=INIIMG==NOISIMG;ARR_ERR=1-ARR_T;Pn=sum(sum(ARR_ERR))/Sz;RES_NOISE=INIIMG-FILTIMG;STDn=std2(RES_NOISE);% subplot(211);% colormap(gray(256));% display3(INIIMG,NOISIMG,FILTIMG);% title(['certfimp.m: Initial, noisy and filtered images; STDprer=',num2str(STDprer,3),'; Pn=',num2str(Pn,3),'; STDreserr=',num2str(STDn,3)])% drawnowFALS_D=RES_NOISE.*ARR_T;Pfd=sum(sum(1-(FALS_D==0)))/Sz;STDfd=std2(FALS_D);MISS=RES_NOISE.*(NOISIMG==FILTIMG).*(ARR_ERR);Pm=sum(sum(1-(MISS==0)))/Sz;STDm=std2(MISS);ESTIM=RES_NOISE.*(1-(NOISIMG==FILTIMG)).*(ARR_ERR);STDest=std2(ESTIM);% subplot(212);% colormap(gray(256));% display3(FALS_D,MISS,ESTIM);% title(['FALS\_D, MISS and ESTIM errors; Pfd=',num2str(Pfd,3),'; STDfd=',num2str(STDfd,3),'; Pm=',num2str(Pm,3),'; SDTm=',num2str(STDm,3),'; STDest=',num2str(STDest,3)])% drawnowOUT=[STDprer Pn STDn Pfd STDfd Pm STDm STDest]