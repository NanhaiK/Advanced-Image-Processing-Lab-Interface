function OUTIMG=pnoise_mb(INPIMG,P)INPIMG = double(INPIMG);% Generating impulse noise with probability of errors P% and demonstrating histogram of 2_D prediction error% as a statistics for noise diagnosis% Call OUTIMG=pnoise(INPIMG,P)clf[SzX SzY]=size(INPIMG);noisemask=rand(SzX,SzY)<P;P_e=sum(sum(noisemask))/(SzX*SzY);OUTIMG=(ones(SzX,SzY)-noisemask).*INPIMG+256*rand(SzX,SzY).*noisemask;colormap(gray(256));subplot(211);display1_mb(OUTIMG);title(['Noisy image, Per=',num2str(P_e)]);drawnowmask=[0.1 0.15 0.1;0.15 -1 0.15;0.1 0.15 0.1];delta=abs(conv2(INPIMG,mask,'same'));mm=max(max(delta));deltam=delta/mm;x=0:mm/255:mm;h_i=imghisto_mb(round(255*deltam))/(SzX*SzY);deltans=abs(conv2(OUTIMG,mask,'same'));mm=max(max(deltans));deltam=deltans/mm;x=0:mm/255:mm;h_n=imghisto_mb(round(255*deltam))/(SzX*SzY);Perr=(20*92)*sum(h_n(165:256))/92;subplot(212);plot(x,h_i.^0.5,x,h_n.^0.5);axis([0 255 0 max(max(h_i.^0.5),max(h_n.^0.5))]);gridtitle('Histograms^{0.5} of 2-D prediction error for the initial and noisy images')