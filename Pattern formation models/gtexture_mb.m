function OUTIMG=gtexture_mb(ImgSz,RD)% Generating Gaussian textures of a Gaussian shaped spectrum % with the spread radius_mb R=(RD*ImgSz/2)^2;% Call OUTIMG=gtexture(ImgSz,Radius in fraction of Imgsize/2);R=(RD*ImgSz/2)^2;rnd=rand(ImgSz)-0.5*ones(ImgSz)+i*(rand(ImgSz)-0.5*ones(ImgSz));colormap(gray(256));subplot(2,2,1);display1_mb(real(rnd));title('gtexture.m: Initial random field');drawnowsubplot(2,2,2);r=radius_mb(ImgSz/2);mask=exp(-(r.^2/R));display1_mb(mask);title('Filter frequency response');drawnowOUT=rnd.*mask;OUTIMG=real(fft2(fftshift(OUT)));subplot(2,2,3);display1_mb(OUTIMG);subplot(2,2,4);display1_mb(OUT);title(['Gaussian field with Gaussian-shaped spectrum; R=',num2str(RD)])