function x1=dendrite_mb(N,THR,Iter, axes_1, axes_2)% DENDRITES: GROWTH WITH SATURATION:ONE CELL, 8 NEIGHBORS,% Size - size of the field% Iter - number of iteration% THR - Threshold for cell's size in % of the field area for% starting growing dendrites% Call x1=dendrite(N,THR,Iter);T=Iter;%N=SIZE;H=zeros(T);time = clock;seed = time([6]);rand('seed',seed);%M=moviein(T);mask=[1 1 1;1 0 1;1 1 1];x=zeros(N,N);x1=zeros(N);trackXY=zeros(N,N);trackX=zeros(T,1); trackY=zeros(T,1);X=[1:N]; Y=[1:N];R=zeros(T,1);sm=zeros(T,1);     x(N/2,N/2)=1;%load dendrmapcolormap(axes_1, jet(256))set(axes_2, 'YAxisLocation', 'right')image(256*(x), 'parent', axes_1);axis(axes_1,  'image');drawnow;%-----------------------------------------------------for t=1:T,    h=1-(sum(sum(x))/N^2)/THR; %      h=-THR*(sum(sum(x)));     H(t)=h;    xmask=conv2(mask,x);     xmask=xmask(2:N+1,2:N+1);    rnd1=rand(N,N)<=1/9;rnd2=rand(N,N)<=2^h/9;    rnd3=rand(N,N)<=3*h/9;rnd4=rand(N,N)<=4*h/9;    rnd5=rand(N,N)<=5*h/9;rnd6=rand(N,N)<=6*h/9;    rnd7=rand(N,N)<=7/9;rnd8=rand(N,N)<=8/9;%     rnd1=rand(N,N)<=1/9;rnd2=rand(N,N)<=2^h/9;%     rnd3=rand(N,N)<=3^h/9;rnd4=rand(N,N)<=4^h/9;%     rnd5=rand(N,N)<=5^h/9;rnd6=rand(N,N)<=6^h/9;%     rnd7=rand(N,N)<=7^h/9;rnd8=rand(N,N)<=8^h/9;    delta1=xmask==1;delta2=xmask==2;    delta3=xmask==3;delta4=xmask==4;    delta5=xmask==5;delta6=xmask==6;    delta7=xmask==7;delta8=xmask==8;    x=x+delta1.*rnd1+delta2.*rnd2+delta3.*rnd3+delta4.*rnd4;    x=x+delta5.*rnd5+delta6.*rnd6+delta7.*rnd7+delta8.*rnd8;    x=double(x>=1);    contour=x-delta8;    x1=x1+x;    sm(t)=sum(sum(x))/(N^2);     if t/8-ceil(t/8)==0,        %subplot(211);        image(16*round(16*x1/t), 'parent', axes_1);axis(axes_1,  'image', 'off');        DisplayAxesTitle( axes_1,['Evolution of the cell after ',num2str(t+1),' iterations'], 'TM',10);        %colorbar(axes_1, 'vert')        drawnow;%         l=sum(sum(contour)); R(t)=l^2/sm(t);%         Xav=sum(X.*sum(x))/sm(t);Yav=sum(Y.*sum(x'))/sm(t);%         trackXY(Xav,Yav)=1;trackX(t)=Xav; trackY(t)=Yav;        plot(axes_2, sm);grid(axes_2, 'on');        set(axes_2, 'YAxisLocation', 'right')        DisplayAxesTitle(axes_2, ['Cell size (in fractions of the field area); Thr=',num2str(THR)], 'TM',10)        drawnow    end    %getframe;end%subplot(211);image(16*round(16*x1/T), 'parent', axes_1);axis(axes_1,  'image', 'off');DisplayAxesTitle(axes_1, ['Evolution of the cell after ',num2str(t),' iterations'], 'TM',10); set(axes_2, 'YAxisLocation', 'right')    plot(axes_2, sm);grid(axes_2, 'on');    DisplayAxesTitle(axes_2, ['Cell size (in fractions of the field area); Thr=',num2str(THR)], 'TM',10)    drawnow%colorbar(axes_1, 'vert');%subplot(212);%plot(sm); grid %title(['Cell size (in fractions of the field area); Thr=',num2str(THR)])