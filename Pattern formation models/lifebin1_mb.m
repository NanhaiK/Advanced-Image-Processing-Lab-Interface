%function OUT=lifebin1_mb(Size,Iter,Plive,Pbirth,Pdeath,History, axes_1, axes_2, axes_3)function OUT=lifebin1_mb(Size,Iter,Plive,Pbirth,Pdeath,History, axes_1, axes_2, axes_3, axes_4)% Stochastic modification of Game of Life% Size=size of the field% Iter- number of iterations% Plive - Initial density (in fraction of the field area) of live cells% Pbirth - probability of cell birth% Pdeath - probability of cell death% If History==1, all the evolution history is displayed; otherwise, only currant state is displayed% Call OUT=lifebin1(Size,Iter,Plive,Pbirth,Pdeath,History);T=Iter;Tstr=int2str(T);N=Size;P=Plive;Pstr=num2str(P);PB=Pbirth;PBstr=num2str(PB);PD=Pdeath;PDstr=num2str(PD);x1=zeros(N);OUT=zeros(N);clctime = clock;seed = time([6]);rand('seed',seed);%M=moviein(T);mask=[1 1 1;1 0 1;1 1 1];colormap(jet(8))%x=len>P;x=double(P>rand(N,N));%subplot(2,2,1);image(255*x, 'parent', axes_1);axis(axes_1,  'off', 'image');DisplayAxesTitle(axes_1, ['Initial seed pattern; Plive=',Pstr], 'TM',10);drawnow;for t=1:T,tstr=int2str(t);x(:,1)=P>rand(N,1);x(:,N)=P>rand(N,1);x(1,:)=P>rand(1,N);x(N,:)=P>rand(1,N);xmask=conv2(mask,x); xmask=xmask(2:N+1,2:N+1);births=rand(N,N)>=1-PB; deaths=rand(N,N)>=PD;delta2=((xmask==2)+deaths)>=1; delta3=(xmask==3).*births;x=double((x.*delta2+delta3)>=1);s(t)=sum(sum(x(2:N-1,2:N-1)))/(N-1)^2;if History==1,   OUT=OUT+x;else    OUT=round(255*x);endcolormap(gray(2^8));% image(OUT, 'parent', axes_1);image(OUT, 'parent', axes_2);% axis(axes_1,  'off', 'image');axis(axes_2,  'off', 'image');% DisplayAxesTitle(axes_1, ['Pattern after ',int2str(t),'th iteration'], 'TM',10);DisplayAxesTitle(axes_2, ['Pattern after ',int2str(t),'th iteration'], 'TM',10); drawnow;% image(127*(x1-x+1), 'parent', axes_2);% DisplayAxesTitle(axes_2, ['Changes; Pbirth=',PBstr,';Pdeath=',PDstr], 'TM',10); image(127*(x1-x+1), 'parent', axes_4);DisplayAxesTitle(axes_4, ['Changes; Pbirth=',PBstr,';Pdeath=',PDstr], 'RM',10);drawnow;plot(axes_3, s,'r', 'linewidth', 2);grid(axes_3,  'on');xlabel(axes_3, 'number of cycles');DisplayAxesTitle(axes_3, 'Fraction of "live" points in the field', 'LM',10);drawnowx1=x;end